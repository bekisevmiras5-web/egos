 <!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<!-- Leaflet -->
<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<style>
/* Баннер-стиль блока */
.map-banner {
  margin-top: 90px;
  width: 100%;
  background: var(--card);
  padding: 20px;
  border-radius: 14px;
  box-shadow: 0 10px 30px rgba(0,0,0,0.1);
}

#map {
  width: 100%;
  height: 400px;
  border-radius: 12px;
  margin-bottom: 14px;
}

#weather-box {
  padding: 14px;
  background: var(--bg);
  border-radius: 10px;
  font-size: 16px;
  box-shadow: 0 6px 14px rgba(0,0,0,0.07);
}
</style>
</head>
<body data-theme="green">

<main class="container">

  <section class="map-banner">
    <h1>Интерактивная карта</h1>
    <p>Нажмите на любую точку карты, чтобы узнать погоду в выбранной области.</p>

    <div id="map"></div>
    <div id="weather-box">Погода появится здесь.</div>
  </section>

</main>

<script src="js/main.js"></script>

<!-- JS карты и погоды -->
<script>
// ===== КАРТА =====
const map = L.map('map').setView([48, 66], 5);

L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
  maxZoom: 18
}).addTo(map);

const weatherBox = document.getElementById('weather-box');

// ===== ПОЛУЧЕНИЕ ПОГОДЫ =====
map.on('click', async (e) => {
  const lat = e.latlng.lat;
  const lon = e.latlng.lng;

  weatherBox.textContent = "Загрузка погоды...";

  try {
    const res = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current=temperature_2m,weather_code`);
    const data = await res.json();

    const temp = data.current.temperature_2m;
    const code = data.current.weather_code;

    const desc = weatherCodeToText(code);

    weatherBox.innerHTML = `
      <h3>Погода в выбранной точке</h3>
      <p><b>Температура:</b> ${temp}°C</p>
      <p><b>Состояние:</b> ${desc}</p>
    `;
  } catch (err) {
    weatherBox.textContent = "Ошибка получения данных.";
    console.error(err);
  }
});

// ===== ДЕКОДЕР ПОГОДЫ =====
function weatherCodeToText(code) {
  const codes = {
    0: "Ясно",
    1: "Преимущественно ясно",
    2: "Переменная облачность",
    3: "Пасмурно",
    45: "Туман",
    48: "Осаждающийся туман",
    51: "Слабая морось",
    53: "Морось",
    55: "Сильная морось",
    61: "Лёгкий дождь",
    63: "Дождь",
    65: "Сильный дождь",
    71: "Снег",
    80: "Лёгкие ливни",
    81: "Ливень",
    82: "Сильный ливень"
  };
  return codes[code] || "Неизвестно";
}
</script>

</body>
</html>

