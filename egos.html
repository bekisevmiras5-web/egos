<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>CtrlRex ‚Äî Team & Project</title>
<style>
  :root{
    --bg:#0b0f19; --panel:#07110b; --text:#e8ffe9; --accent:#00ff88;
    --glass: rgba(255,255,255,0.03);
    --transition: 220ms cubic-bezier(.2,.9,.3,1);
    --nav-height: 64px;
  }
  *{box-sizing:border-box}
  html,body{height:100%; margin:0; font-family:Inter,Arial,sans-serif; -webkit-font-smoothing:antialiased; background:var(--bg); color:var(--text)}
  a{color:inherit}
  header.topbar{
    position:fixed; left:0; right:0; top:0; height:var(--nav-height);
    display:flex; align-items:center; gap:12px; padding:8px 12px;
    background:linear-gradient(180deg, rgba(0,0,0,0.48), rgba(0,0,0,0.28));
    z-index:1300; backdrop-filter: blur(6px);
  }
  .brand{font-weight:800;color:var(--accent);letter-spacing:1px;cursor:pointer; padding:6px 10px; border-radius:8px}
  .nav-items{ display:flex; gap:8px; align-items:center; margin-left:8px; overflow:auto; -webkit-overflow-scrolling:touch }
  .nav-btn{ background:transparent; border:none; color:rgba(255,255,255,0.9); padding:8px 12px; border-radius:10px; font-weight:700; cursor:pointer; white-space:nowrap; }
  .nav-btn.active{ color:var(--accent) }
  .top-actions{ margin-left:auto; display:flex; gap:8px; align-items:center }
  .icon-btn{ background:var(--glass); border:1px solid rgba(255,255,255,0.03); padding:8px; border-radius:10px; cursor:pointer }
  .banner{ margin-top:calc(var(--nav-height)); height:220px; display:flex; align-items:center; justify-content:center; position:relative; overflow:hidden; }
  .banner img{ width:100%; height:100%; object-fit:cover; filter:contrast(1.02) brightness(.95) }
  .banner .overlay{ position:absolute; inset:0; background:linear-gradient(180deg, rgba(0,0,0,0.35), rgba(0,0,0,0.55)); }
  .banner .title{ position:absolute; z-index:2; color:#fff; font-weight:800; font-size:28px; text-shadow:0 12px 40px rgba(0,0,0,0.6) }

  .wrap{ max-width:1100px; margin:28px auto; padding:12px; }
  section.page{ padding:36px 12px; border-radius:12px; margin-bottom:20px; background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent); border:1px solid rgba(255,255,255,0.02) }

  .team-grid{ display:flex; gap:20px; align-items:flex-start; flex-wrap:wrap; }
  .photo-rail{ flex:1; min-width:300px; max-width:480px; height:420px; background:rgba(0,0,0,0.08); border-radius:12px; overflow:hidden; position:relative; border:2px solid rgba(0,255,136,0.06) }
  .rail-inner{ display:flex; gap:16px; padding:18px; position:absolute; left:0; top:50%; transform:translateY(-50%); transition:transform .6s cubic-bezier(.2,.9,.3,1) }
  .rail-inner img{ width:260px; height:360px; object-fit:cover; border-radius:12px; box-shadow:0 0 20px var(--accent); border:2px solid var(--accent); filter:brightness(.85) }
  .member-card{ flex:1; min-width:300px; padding:18px; background:linear-gradient(180deg, rgba(0,0,0,0.03), rgba(255,255,255,0.01)); border-radius:12px; border:1px solid rgba(255,255,255,0.02) }
  .member-name{ font-size:22px; color:var(--accent); margin:0 0 6px }
  .member-role{ font-weight:700; color:rgba(255,255,255,0.9) }
  .member-desc{ margin-top:14px; color:rgba(255,255,255,0.85) }

  .controls{ display:flex; gap:12px; margin-top:16px; flex-wrap:wrap }
  .btn{ padding:10px 14px; border-radius:10px; border:none; cursor:pointer; background:var(--accent); color:#022; font-weight:800 }

  .social-links{ display:flex; gap:12px; flex-wrap:wrap; justify-content:center }
  .social-links a{ display:inline-flex; align-items:center; justify-content:center; width:64px; height:64px; border-radius:50%; background:rgba(0,255,136,0.06); border:2px solid rgba(0,255,136,0.08) }

  .stickers{ position:fixed; left:14px; top:120px; display:flex; flex-direction:column; gap:12px; z-index:1400; }
  .sticker{ width:56px; height:56px; border-radius:12px; display:flex; align-items:center; justify-content:center; font-size:22px; background:var(--glass); border:1px solid rgba(255,255,255,0.03); color:var(--accent); box-shadow:0 10px 30px rgba(0,200,83,0.06); cursor:default }
  .panel{ position:fixed; left:86px; width:320px; background:linear-gradient(180deg, rgba(8,10,8,0.98), rgba(12,14,12,0.98)); border-radius:12px; padding:12px; border:1px solid rgba(255,255,255,0.02); box-shadow:0 30px 80px rgba(0,0,0,0.6); transform:translateX(-10px) scale(.98); opacity:0; pointer-events:none; transition:transform .26s, opacity .22s; z-index:1380; }
  .panel.open{ transform:translateX(0) scale(1); opacity:1; pointer-events:auto; }
  .panel h3{ margin:6px 0 10px; color:var(--accent) }
  .option{ padding:8px 10px; border-radius:8px; cursor:pointer; color:rgba(255,255,255,0.92); margin-bottom:6px }
  .option:hover{ background:rgba(255,255,255,0.02) }
  .theme-strip{ display:flex; gap:10px; overflow:hidden; padding:6px }
  .theme-card{ min-width:110px; height:90px; border-radius:10px; display:flex; flex-direction:column; justify-content:flex-end; padding:8px; font-weight:700; color:#fff; border:2px solid rgba(255,255,255,0.02) }

  .tg-float{ position:fixed; right:16px; bottom:16px; width:64px; height:64px; border-radius:50%; display:flex; align-items:center; justify-content:center; background:linear-gradient(180deg,var(--accent), #2dbf7a); box-shadow:0 12px 36px rgba(0,200,83,0.12); z-index:1500; cursor:pointer; touch-action:none; user-select:none; }
  footer{ text-align:center; padding:22px 12px; color:rgba(255,255,255,0.45) }

  @media(max-width:900px){
    .photo-rail{ max-width:100%; min-width:100%; height:340px }
    .rail-inner img{ width:240px; height:320px }
    .member-card{ min-width:100% }
  }
  @media(max-width:660px){
    .nav-btn{ padding:6px 8px; font-size:14px }
    .banner{ height:160px }
    .brand{ padding:6px }
    .tg-float{ right:8px; bottom:8px; width:56px; height:56px }
    .stickers{ left:8px; top:100px }
    .panel{ left:62px; width:260px }
  }
  .hide{ display:none !important }
  .center{ text-align:center }
</style>
</head>
<body>

<header class="topbar" id="topbar">
  <div class="brand" id="brand">CtrlRex</div>
  <nav class="nav-items" id="navItems" aria-label="–ù–∞–≤–∏–≥–∞—Ü–∏—è">
    <button class="nav-btn" data-target="home">–ì–ª–∞–≤–Ω–∞—è</button>
    <button class="nav-btn" data-target="about">–û –∫–æ–º–∞–Ω–¥–µ</button>
    <button class="nav-btn" data-target="project">–ü—Ä–æ–µ–∫—Ç</button>
    <button class="nav-btn" data-target="contact">–ö–æ–Ω—Ç–∞–∫—Ç—ã</button>
  </nav>
  <div class="top-actions">
    <div class="icon-btn" id="openStickers" title="–ú–µ–Ω—é">‚ò∞</div>
  </div>
</header>

<section id="home" class="banner" aria-label="–ì–ª–∞–≤–Ω–∞—è">
  <img src="CtrlRex.jpg" alt="CtrlRex banner" id="bannerImg">
  <div class="overlay"></div>
  <div class="title" id="bannerTitle">CtrlRex ‚Äî Innovation ‚Ä¢ Robotics ‚Ä¢ Future</div>
</section>

<main class="wrap">
  <section id="about" class="page" aria-labelledby="aboutTitle">
    <h2 id="aboutTitle" style="color:var(--accent)">–û –∫–æ–º–∞–Ω–¥–µ</h2>
    <p>–ú—ã ‚Äî –∫–æ–º–∞–Ω–¥–∞ CtrlRex, —É—á–∞—Å—Ç–Ω–∏–∫–∏ FIRST LEGO League. –ù–∏–∂–µ ‚Äî –∫—Ä–∞—Ç–∫–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ –∫–∞–∂–¥–æ–≥–æ —É—á–∞—Å—Ç–Ω–∏–∫–∞ –∏ —Ñ–æ—Ç–æ–ø–æ–µ–∑–¥.</p>
    <div class="team-grid" role="region" aria-label="–ö–æ–º–∞–Ω–¥–∞">
      <div class="photo-rail" id="photoRail" aria-hidden="false">
        <div class="rail-inner" id="railInner"></div>
      </div>
      <div class="member-card" id="memberCard">
        <h3 class="member-name" id="memberName">–ò–º—è</h3>
        <div class="member-role" id="memberRole">–†–æ–ª—å</div>
        <div class="member-desc" id="memberDesc">–û–ø–∏—Å–∞–Ω–∏–µ</div>
        <div class="controls">
          <button class="btn" id="prevMember">‚óÄ –ù–∞–∑–∞–¥</button>
          <button class="btn" id="nextMember">–î–∞–ª–µ–µ ‚ñ∂</button>
        </div>
      </div>
    </div>
  </section>

  <section id="project" class="page" aria-labelledby="projectTitle">
    <h2 id="projectTitle" style="color:var(--accent)">–ê–†–•–ï–û–ë–û–¢</h2>
    <p id="projectDesc">–ú—ã —Ä–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —ç–∫–æ—Å–∏—Å—Ç–µ–º—É –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö —Ä–∞—Å–∫–æ–ø–æ–∫: –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç-—Ä–æ–±–æ—Ç, –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞—Ö–æ–¥–æ–∫ –∏ —Å–∏—Å—Ç–µ–º–∞ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏.</p>
  </section>

  <section id="contact" class="page" aria-labelledby="contactTitle">
    <h2 id="contactTitle" style="color:var(--accent)">–ö–æ–Ω—Ç–∞–∫—Ç—ã</h2>
    <p class="center">–ü–æ–¥–ø–∏—Å—ã–≤–∞–π—Ç–µ—Å—å –∏ –ø–∏—à–∏—Ç–µ –Ω–∞–º ‚Äî Instagram / Telegram / YouTube / TikTok</p>
    <div class="center" style="margin-top:12px">
      <a href="https://www.instagram.com/ctrlrex_fll/?hl=ru" target="_blank" class="icon-btn" style="margin-right:8px">Instagram</a>
      <a href="https://t.me/Kirito2402_bot" target="_blank" class="icon-btn" style="margin-right:8px">Telegram-–±–æ—Ç</a>
      <a href="https://www.youtube.com/channel/UCgOva9K2skcL63d8Q2jUZOg" target="_blank" class="icon-btn">YouTube</a>
    </div>
  </section>
</main>

<!-- fixed stickers (not draggable) -->
<div class="stickers" id="stickersRoot" aria-hidden="false">
  <div class="sticker" id="sticker-lang" title="–Ø–∑—ã–∫">üåê</div>
  <div class="sticker" id="sticker-theme" title="–¢–µ–º—ã">üé®</div>
  <div class="sticker" id="sticker-music" title="–ú—É–∑—ã–∫–∞">üéµ</div>
</div>

<!-- panels -->
<div class="panel" id="langPanel" aria-hidden="true" style="top:120px">
  <h3 id="langPanelTitle">–í—ã–±—Ä–∞—Ç—å —è–∑—ã–∫</h3>
  <div class="option" data-lang="ru">–†—É—Å—Å–∫–∏–π üá∑üá∫</div>
  <div class="option" data-lang="kz">“ö–∞–∑–∞“õ—à–∞ üá∞üáø</div>
  <div class="option" data-lang="en">English üá¨üáß</div>
</div>

<div class="panel" id="themePanel" aria-hidden="true" style="top:160px; max-height:420px; overflow:auto">
  <h3>–¢–µ–º—ã –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è</h3>
  <div class="theme-strip" id="themeStrip"></div>
  <div style="margin-top:8px; font-size:13px; color:rgba(255,255,255,0.7)">–í—ã–±—Ä–∞–Ω–Ω–∞—è —Ç–µ–º–∞ –ø–æ–¥—Å–≤–µ—á–∏–≤–∞–µ—Ç –ª–æ–≥–æ –∏ —ç–ª–µ–º–µ–Ω—Ç—ã</div>
</div>

<div class="panel" id="musicPanel" aria-hidden="true" style="top:220px">
  <h3 id="musicPanelTitle">–ú—É–∑—ã–∫–∞</h3>
  <div style="display:flex; gap:12px; align-items:center">
    <button class="btn" id="playToggle">‚ñ∫ –ü–∞—É–∑–∞</button>
    <div style="flex:1">
      <div id="trackTitle" style="font-weight:700">snowfall.mp3</div>
      <div style="font-size:13px; color:rgba(255,255,255,0.7)">–ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ –≤—Ö–æ–¥–µ (–µ—Å–ª–∏ –±—Ä–∞—É–∑–µ—Ä —Ä–∞–∑—Ä–µ—à–∞–µ—Ç)</div>
    </div>
  </div>
  <div style="margin-top:10px">
    <button class="option" id="stopMusicBtn">–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å</button>
  </div>
</div>

<!-- draggable Telegram button (only this is draggable and snaps to corners) -->
<a id="tgFloat" class="tg-float" href="https://t.me/Kirito2402_bot" target="_blank" title="–û—Ç–∫—Ä—ã—Ç—å Telegram-–±–æ—Ç">
  <svg viewBox="0 0 24 24" width="28" height="28" fill="#021"><path d="M21 3.004L3.5 10.6c-.6.23-.593.74-.11.93l3.84 1.23 1.46 4.66c.17.56.61.71 1.03.45l2.86-2.06 3.7 2.7c.67.5 1.15.24 1.32-.6l3-12.14c.29-1.22-.45-1.75-1.46-1.35z"/></svg>
</a>

<audio id="bgAudio" preload="auto" src="snowfall.mp3" loop></audio>
<footer>¬© CtrlRex ‚Äî –∫–æ–º–∞–Ω–¥–∞ FLL</footer>

<script>
/* ---------- data (same as before) ---------- */
const LANG_DATA = {
  ru:{ nav:['–ì–ª–∞–≤–Ω–∞—è','–û –∫–æ–º–∞–Ω–¥–µ','–ü—Ä–æ–µ–∫—Ç','–ö–æ–Ω—Ç–∞–∫—Ç—ã'], bannerTitle:'CtrlRex ‚Äî Innovation ‚Ä¢ Robotics ‚Ä¢ Future', aboutTitle:'–û –∫–æ–º–∞–Ω–¥–µ', projectTitle:'–ê–†–•–ï–û–ë–û–¢', projectDesc:'–ú—ã —Ä–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —ç–∫–æ—Å–∏—Å—Ç–µ–º—É –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö —Ä–∞—Å–∫–æ–ø–æ–∫: –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç-—Ä–æ–±–æ—Ç, –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞—Ö–æ–¥–æ–∫ –∏ —Å–∏—Å—Ç–µ–º–∞ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏.', contactTitle:'–ö–æ–Ω—Ç–∞–∫—Ç—ã', musicPanelTitle:'–ú—É–∑—ã–∫–∞', langPanelTitle:'–í—ã–±—Ä–∞—Ç—å —è–∑—ã–∫', play:'–ü—É—Å–∫', pause:'–ü–∞—É–∑–∞', stop:'–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å' },
  kz:{ nav:['–ë–∞—Å—Ç—ã –±–µ—Ç','–¢–æ–ø','–ñ–æ–±–∞','–ë–∞–π–ª–∞–Ω—ã—Å'], bannerTitle:'CtrlRex ‚Äî Innovation ‚Ä¢ Robotics ‚Ä¢ Future', aboutTitle:'–ë—ñ–∑–¥—ñ“£ –∫–æ–º–∞–Ω–¥–∞', projectTitle:'–ê–†–•–ï–û–ë–û–¢', projectDesc:'–ë—ñ–∑ “õ–∞—É—ñ–ø—Å—ñ–∑ “õ–∞–∑–±–∞–ª–∞—Ä“ì–∞ –∞—Ä–Ω–∞–ª“ì–∞–Ω —ç–∫–æ–∂“Ø–π–µ–Ω—ñ –¥–∞–º—ã—Ç–∞–º—ã–∑: –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª–¥—ã —Ä–æ–±–æ—Ç, –¥–µ—Ä–µ–∫—Ç–µ—Ä –±–∞–∑–∞—Å—ã –∂”ô–Ω–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∂“Ø–π–µ—Å—ñ.', contactTitle:'–ë–∞–π–ª–∞–Ω—ã—Å', musicPanelTitle:'–ú—É–∑—ã–∫–∞', langPanelTitle:'–¢—ñ–ª–¥—ñ —Ç–∞“£–¥–∞—É', play:'–û–π–Ω–∞—Ç—É', pause:'–¢–æ“õ—Ç–∞—Ç—É', stop:'–¢–æ“õ—Ç–∞—Ç—É' },
  en:{ nav:['Home','Team','Project','Contact'], bannerTitle:'CtrlRex ‚Äî Innovation ‚Ä¢ Robotics ‚Ä¢ Future', aboutTitle:'About the team', projectTitle:'ARCHEOBOT', projectDesc:'We develop an ecosystem for safe excavations: intelligent robot, finds database and visualization system.', contactTitle:'Contact', musicPanelTitle:'Music', langPanelTitle:'Select language', play:'Play', pause:'Pause', stop:'Stop' }
};

const TEAM = [
  { ru:{name:'–ú–∏—Ä–∞—Å –ë–µ–∫–∏—à–µ–≤', role:'–ö–∞–ø–∏—Ç–∞–Ω, –∏–Ω–∂–µ–Ω–µ—Ä, –∫–æ–¥–µ—Ä', desc:'–£–≤–µ—Ä–µ–Ω–Ω–æ –≤–µ–¥—ë—Ç –∫–æ–º–∞–Ω–¥—É –≤–ø–µ—Ä—ë–¥. –ü—Ä–æ–µ–∫—Ç–∏—Ä—É–µ—Ç –∏ –∫–æ–¥–∏—Ç.'}, kz:{name:'–ú–∏—Ä–∞—Å –ë–µ–∫–∏—à–µ–≤', role:'–ö–∞–ø–∏—Ç–∞–Ω, –∏–Ω–∂–µ–Ω–µ—Ä, –∫–æ–¥–µ—Ä', desc:'–¢–æ–ø—Ç—ã —Å–µ–Ω—ñ–º–¥—ñ –±–∞—Å“õ–∞—Ä–∞–¥—ã. –ñ–æ–±–∞–ª–∞–π–¥—ã –∂”ô–Ω–µ –ø—Ä–æ–≥—Ä–∞–º–º–∞–ª–∞–π–¥—ã.'}, en:{name:'Miras Bekishev', role:'Captain, engineer, coder', desc:'Leads the team confidently. Designs and codes.'}, img:'miras.jpg' },
  { ru:{name:'–ê–π–±–∏–±–∏', role:'–ö–æ–Ω—Ç–µ–Ω—Ç-–¥–∏–∑–∞–π–Ω–µ—Ä', desc:'–°–æ–∑–¥–∞—ë—Ç –≤–∏–∑—É–∞–ª—å–Ω—É—é –∫–æ–Ω—Ü–µ–ø—Ü–∏—é –∏ –∫–æ–Ω—Ç–µ–Ω—Ç.'}, kz:{name:'–ê–π–±–∏–±–∏', role:'–ö–æ–Ω—Ç–µ–Ω—Ç-–¥–∏–∑–∞–π–Ω–µ—Ä', desc:'–í–∏–∑—É–∞–ª–¥—ã —Ç“±–∂—ã—Ä—ã–º–¥–∞–º–∞ –º–µ–Ω –∫–æ–Ω—Ç–µ–Ω—Ç –∂–∞—Å–∞–π–¥—ã.'}, en:{name:'Aibibi', role:'Content designer', desc:'Creates visual concepts and content.'}, img:'aibibi.jpg' },
  { ru:{name:'–ì—É–ª—å–±–∞–∫—ã—Ç', role:'SMM-—Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç', desc:'–£–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ—Ü–∏–∞–ª—å–Ω—ã–º–∏ —Å–µ—Ç—è–º–∏ –∏ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–µ–π.'}, kz:{name:'–ì“Ø–ª–±–∞“õ—ã—Ç', role:'SMM –º–∞–º–∞–Ω—ã', desc:'”ò–ª–µ—É–º–µ—Ç—Ç—ñ–∫ –∂–µ–ª—ñ–ª–µ—Ä–¥—ñ –±–∞—Å“õ–∞—Ä–∞–¥—ã –∂”ô–Ω–µ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è –∂–∞—Å–∞–π–¥—ã.'}, en:{name:'Gulbakyt', role:'SMM specialist', desc:'Manages social media and communication.'}, img:'gulbakyt.jpg' },
  { ru:{name:'–ê–±–∏–ª—å–º–∞–Ω—Å—É—Ä', role:'–ò–Ω–∂–µ–Ω–µ—Ä, –∫–æ–¥–µ—Ä', desc:'–†–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –º–µ—Ö–∞–Ω–∏–∫—É –∏ –∞–ª–≥–æ—Ä–∏—Ç–º—ã —Ä–æ–±–æ—Ç–∞.'}, kz:{name:'”ò–±—ñ–ª–º–∞–Ω—Å“±—Ä', role:'–ò–Ω–∂–µ–Ω–µ—Ä, –∫–æ–¥–µ—Ä', desc:'–†–æ–±–æ—Ç—Ç—ã“£ –º–µ—Ö–∞–Ω–∏–∫–∞—Å—ã–Ω –∂”ô–Ω–µ –∞–ª–≥–æ—Ä–∏—Ç–º–¥–µ—Ä—ñ–Ω –∂–∞—Å–∞–π–¥—ã.'}, en:{name:'Abilmansur', role:'Engineer, coder', desc:'Develops robot mechanics and algorithms.'}, img:'abulat.jpg' },
  { ru:{name:'–ê–π—Å—É–ª—Ç–∞–Ω', role:'–†–µ—Å—ë—Ä—á–µ—Ä', desc:'–ò—â–µ—Ç —Ä–µ—à–µ–Ω–∏—è, –ø—Ä–æ–≤–æ–¥–∏—Ç –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è.'}, kz:{name:'–ê–π—Å—É–ª—Ç–∞–Ω', role:'–ó–µ—Ä—Ç—Ç–µ—É—à—ñ', desc:'–®–µ—à—ñ–º–¥–µ—Ä–¥—ñ —ñ–∑–¥–µ–π–¥—ñ, –∑–µ—Ä—Ç—Ç–µ—É–ª–µ—Ä –∂“Ø—Ä–≥—ñ–∑–µ–¥—ñ.'}, en:{name:'Aisultan', role:'Researcher', desc:'Finds solutions and conducts research.'}, img:'aisultan.jpg' },
  { ru:{name:'–ê—Ä—Å—ã–ª–∞–Ω', role:'–°–ø–∏–∫–µ—Ä –ø–æ –ø—Ä–æ–µ–∫—Ç—É', desc:'–ü—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –ø—Ä–æ–µ–∫—Ç, –≤—ã—Å—Ç—É–ø–∞–µ—Ç –ø–µ—Ä–µ–¥ –∂—é—Ä–∏.'}, kz:{name:'–ê—Ä—Å—ã–ª–∞–Ω', role:'–ñ–æ–±–∞ —Å–ø–∏–∫–µ—Ä—ñ', desc:'–ñ–æ–±–∞–Ω—ã —Ç–∞–Ω—ã—Å—Ç—ã—Ä–∞–¥—ã, —à–µ—à–µ–Ω–¥—ñ–∫ –µ—Ç–µ–¥—ñ.'}, en:{name:'Arsylan', role:'Project speaker', desc:'Presents the project and speaks to judges.'}, img:'arsylan.jpg' },
  { ru:{name:'–ï—Ä–∞—Å—ã–ª', role:'–°–ø–∏–∫–µ—Ä –ø—Ä–æ–µ–∫—Ç–∞', desc:'–ß—ë—Ç–∫–æ –∏ —Å–ø–æ–∫–æ–π–Ω–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –∏–¥–µ–∏ –∫–æ–º–∞–Ω–¥—ã.'}, kz:{name:'–ï—Ä–∞—Å—ã–ª', role:'–ñ–æ–±–∞ —Å–ø–∏–∫–µ—Ä—ñ', desc:'–ê–Ω—ã“õ –∂”ô–Ω–µ —Ç—ã–Ω—ã—à—Ç—ã“õ–ø–µ–Ω –∂–æ–±–∞–Ω—ã “±—Å—ã–Ω–∞–¥—ã.'}, en:{name:'Yerasyl', role:'Project speaker', desc:'Presents ideas clearly and calmly.'}, img:'erasyl.jpg' },
  { ru:{name:'–ê–π–≥–∞–Ω—ã–º', role:'–ò–Ω–∂–µ–Ω–µ—Ä', desc:'–°–æ–±–∏—Ä–∞–µ—Ç –∏ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç –º–µ—Ö–∞–Ω–∏–∑–º—ã.'}, kz:{name:'–ê–π“ì–∞–Ω—ã–º', role:'–ò–Ω–∂–µ–Ω–µ—Ä', desc:'–ú–µ—Ö–∞–Ω–∏–∑–º–¥–µ—Ä–¥—ñ –∂–∏–Ω–∞–π–¥—ã –∂”ô–Ω–µ —Ç–µ—Å—Ç—ñ–ª–µ—É–¥–µ–Ω ”©—Ç–∫—ñ–∑–µ–¥—ñ.'}, en:{name:'Aiganim', role:'Engineer', desc:'Assembles and tests mechanisms.'}, img:'aiganym.jpg' }
];

const THEMES = [
  { id:'classic', name:'Classic Wave', vars:{'--bg':'#0b0f19','--panel':'#07110b','--text':'#e8ffe9','--accent':'#00ff88'} },
  { id:'cyber', name:'Cyber Neon', vars:{'--bg':'#05010b','--panel':'#0b0211','--text':'#f4ecff','--accent':'#9a6dff'} },
  { id:'emerald', name:'Emerald Core', vars:{'--bg':'#001208','--panel':'#041815','--text':'#e8fff1','--accent':'#19d087'} },
  { id:'lime', name:'Quantum Lime', vars:{'--bg':'#0a0a04','--panel':'#0d0d03','--text':'#f7ffec','--accent':'#cfff7f'} },
  { id:'matrix', name:'Dark Matrix', vars:{'--bg':'#000','--panel':'#061812','--text':'#eafff1','--accent':'#00ff99'} }
];

/* ---------- state ---------- */
let currentLang = localStorage.getItem('ctrlrex_lang') || 'ru';
let currentTheme = localStorage.getItem('ctrlrex_theme') || 'classic';
let memberIndex = 0;

/* ---------- refs ---------- */
const navBtns = document.querySelectorAll('.nav-btn');
const bannerTitle = document.getElementById('bannerTitle');
const aboutTitle = document.getElementById('aboutTitle');
const projectTitle = document.getElementById('projectTitle');
const projectDesc = document.getElementById('projectDesc');
const contactTitle = document.getElementById('contactTitle');
const memberName = document.getElementById('memberName');
const memberRole = document.getElementById('memberRole');
const memberDesc = document.getElementById('memberDesc');
const railInner = document.getElementById('railInner');
const stickerLang = document.getElementById('sticker-lang');
const stickerTheme = document.getElementById('sticker-theme');
const stickerMusic = document.getElementById('sticker-music');
const langPanel = document.getElementById('langPanel');
const themePanel = document.getElementById('themePanel');
const musicPanel = document.getElementById('musicPanel');
const bgAudio = document.getElementById('bgAudio');
const playToggle = document.getElementById('playToggle');
const stopMusicBtn = document.getElementById('stopMusicBtn');
const tgFloat = document.getElementById('tgFloat');

/* ---------- helpers ---------- */
function applyThemeById(id){
  const theme = THEMES.find(t=>t.id===id) || THEMES[0];
  Object.entries(theme.vars).forEach(([k,v])=> document.documentElement.style.setProperty(k,v));
  currentTheme = theme.id;
  localStorage.setItem('ctrlrex_theme', currentTheme);
  document.getElementById('brand').style.textShadow = `0 0 14px ${getComputedStyle(document.documentElement).getPropertyValue('--accent')}`;
}
function setLang(lang){
  currentLang = lang;
  localStorage.setItem('ctrlrex_lang', lang);
  const L = LANG_DATA[lang];
  [...document.querySelectorAll('.nav-btn')].forEach((b,i)=> b.textContent = L.nav[i]);
  bannerTitle.textContent = L.bannerTitle;
  aboutTitle.textContent = L.aboutTitle;
  projectTitle.textContent = L.projectTitle;
  projectDesc.textContent = L.projectDesc;
  contactTitle.textContent = L.contactTitle;
  document.getElementById('musicPanelTitle').textContent = L.musicPanelTitle || L.musicPanelTitle;
  document.getElementById('langPanelTitle').textContent = L.langPanelTitle || L.langPanelTitle;
  playToggle.textContent = bgAudio.paused ? (L.play || 'Play') : (L.pause || 'Pause');
  renderMember();
}

/* ---------- team rendering ---------- */
function renderRail(){
  railInner.innerHTML = '';
  TEAM.forEach(t=>{
    const img = document.createElement('img');
    img.src = t.img || 'CtrlRex.jpg';
    img.alt = t.ru.name;
    railInner.appendChild(img);
  });
  updateRailPosition();
}
function updateRailPosition(){
  const imgs = railInner.children;
  if(!imgs.length) return;
  const w = imgs[0].getBoundingClientRect().width + 16;
  const offset = (w * memberIndex) - ((document.querySelector('.photo-rail').clientWidth - w) / 2);
  railInner.style.transform = `translateX(${ -offset }px)`;
}
function renderMember(){
  const t = TEAM[memberIndex];
  memberName.textContent = t[currentLang].name;
  memberRole.textContent = t[currentLang].role;
  memberDesc.textContent = t[currentLang].desc;
  updateRailPosition();
}

/* ---------- navigation ---------- */
navBtns.forEach(btn=>{
  btn.addEventListener('click', ()=> {
    const target = btn.dataset.target;
    const el = document.getElementById(target);
    if(el){
      window.scrollTo({ top: el.getBoundingClientRect().top + window.scrollY - (parseInt(getComputedStyle(document.documentElement).getPropertyValue('--nav-height')) || 64) - 8, behavior:'smooth' });
      navBtns.forEach(b=>b.classList.toggle('active', b === btn));
    }
  });
});

/* ---------- member controls ---------- */
document.getElementById('nextMember').addEventListener('click', ()=> { memberIndex = (memberIndex+1) % TEAM.length; renderMember(); });
document.getElementById('prevMember').addEventListener('click', ()=> { memberIndex = (memberIndex-1+TEAM.length) % TEAM.length; renderMember(); });

/* ---------- themes setup ---------- */
const themeStrip = document.getElementById('themeStrip');
THEMES.forEach(theme=>{
  const card = document.createElement('div');
  card.className = 'theme-card';
  card.textContent = theme.name;
  card.style.background = `linear-gradient(180deg, ${theme.vars['--bg']}, ${theme.vars['--accent']})`;
  card.addEventListener('click', ()=> applyThemeById(theme.id));
  themeStrip.appendChild(card);
});

/* ---------- panels open/close ---------- */
function closeAllPanels(){ [langPanel, themePanel, musicPanel].forEach(p=>{ p.classList.remove('open'); p.setAttribute('aria-hidden','true') }); document.getElementById('dim')?.remove(); }
function openPanel(panel){
  closeAllPanels();
  panel.classList.add('open');
  panel.setAttribute('aria-hidden','false');
  const dim = document.createElement('div'); dim.id='dim'; dim.style.cssText='position:fixed;inset:0;background:rgba(0,0,0,0.35);z-index:1370'; document.body.appendChild(dim);
  dim.addEventListener('click', closeAllPanels, {once:true});
}
document.getElementById('sticker-lang').addEventListener('click', ()=> openPanel(langPanel));
document.getElementById('sticker-theme').addEventListener('click', ()=> openPanel(themePanel));
document.getElementById('sticker-music').addEventListener('click', ()=> openPanel(musicPanel));
[...langPanel.querySelectorAll('.option')].forEach(opt=> opt.addEventListener('click', ()=> { setLang(opt.dataset.lang); closeAllPanels(); }) );

/* ---------- music controls ---------- */
function tryAutoPlay(){
  bgAudio.volume = 0.6;
  const playPromise = bgAudio.play();
  if(playPromise !== undefined){
    playPromise.then(()=> { playToggle.textContent = LANG_DATA[currentLang].pause || 'Pause'; }).catch(()=> { playToggle.textContent = LANG_DATA[currentLang].play || 'Play'; });
  }
}
playToggle.addEventListener('click', ()=> {
  if(bgAudio.paused){ bgAudio.play(); playToggle.textContent = LANG_DATA[currentLang].pause || 'Pause'; }
  else{ bgAudio.pause(); playToggle.textContent = LANG_DATA[currentLang].play || 'Play'; }
});
stopMusicBtn.addEventListener('click', ()=> { bgAudio.pause(); bgAudio.currentTime = 0; playToggle.textContent = LANG_DATA[currentLang].play || 'Play'; });

/* ---------- try autoplay ---------- */
window.addEventListener('load', ()=> {
  applyThemeById(localStorage.getItem('ctrlrex_theme') || currentTheme);
  setLang(localStorage.getItem('ctrlrex_lang') || currentLang);
  renderRail();
  renderMember();
  setTimeout(()=> tryAutoPlay(), 300);
});

/* ---------- draggable Telegram float (only this) ---------- */
(function initTgDrag(){
  const el = tgFloat;
  // restore saved pos if any
  const saved = localStorage.getItem('tg_float_pos');
  if(saved){ try{ const p = JSON.parse(saved); el.style.left = p.left; el.style.top = p.top; el.style.right = 'auto'; el.style.bottom = 'auto'; }catch(e){} }
  // pointer drag
  let dragging = false, offsetX=0, offsetY=0;
  el.addEventListener('pointerdown', (ev)=> {
    ev.preventDefault();
    el.setPointerCapture(ev.pointerId);
    dragging = true;
    el.style.transition = 'none';
    const rect = el.getBoundingClientRect();
    offsetX = ev.clientX - rect.left;
    offsetY = ev.clientY - rect.top;
  });
  el.addEventListener('pointermove', (ev)=> {
    if(!dragging) return;
    const x = ev.clientX - offsetX;
    const y = ev.clientY - offsetY;
    // clamp inside viewport
    const left = Math.max(6, Math.min(window.innerWidth - el.offsetWidth - 6, x));
    const top = Math.max(6 + (parseInt(getComputedStyle(document.documentElement).getPropertyValue('--nav-height')) || 64), Math.min(window.innerHeight - el.offsetHeight - 6, y));
    el.style.left = left + 'px';
    el.style.top = top + 'px';
    el.style.right = 'auto';
    el.style.bottom = 'auto';
  });
  el.addEventListener('pointerup', (ev)=> {
    if(!dragging) return;
    dragging = false;
    el.releasePointerCapture(ev.pointerId);
    // snap to nearest corner
    el.style.transition = 'left 220ms cubic-bezier(.2,.9,.3,1), top 220ms cubic-bezier(.2,.9,.3,1)';
    const rect = el.getBoundingClientRect();
    const corners = [
      {x:8, y: (parseInt(getComputedStyle(document.documentElement).getPropertyValue('--nav-height'))||64) + 8}, // left-top
      {x: window.innerWidth - rect.width - 8, y: (parseInt(getComputedStyle(document.documentElement).getPropertyValue('--nav-height'))||64) + 8}, // right-top
      {x:8, y: window.innerHeight - rect.height - 8}, // left-bottom
      {x: window.innerWidth - rect.width - 8, y: window.innerHeight - rect.height - 8} // right-bottom
    ];
    let minD = Infinity, best = corners[0];
    corners.forEach(c=>{
      const dx = rect.left - c.x; const dy = rect.top - c.y;
      const d = dx*dx + dy*dy;
      if(d < minD){ minD = d; best = c; }
    });
    el.style.left = best.x + 'px';
    el.style.top = best.y + 'px';
    // save position
    localStorage.setItem('tg_float_pos', JSON.stringify({ left: el.style.left, top: el.style.top }));
  });
  // ensure touch works: prevent default double-tap zoom issues
  el.addEventListener('touchstart',(e)=> e.preventDefault(), {passive:false});
})();

/* ---------- small extras ---------- */
window.addEventListener('resize', ()=> { renderMember(); });
document.addEventListener('keydown', (e)=> { if(e.key==='ArrowRight'){ memberIndex=(memberIndex+1)%TEAM.length; renderMember(); } if(e.key==='ArrowLeft'){ memberIndex=(memberIndex-1+TEAM.length)%TEAM.length; renderMember(); } });

</script>
</body>
</html>